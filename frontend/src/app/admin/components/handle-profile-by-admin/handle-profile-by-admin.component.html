<div class="admin-users-container">
  <h2 class="page-header">User Management</h2>

  <div class="controls-section">
    <div class="search-box">
      <input type="text" 
             class="search-input" 
             placeholder="Search users..." 
             [(ngModel)]="searchTerm"
             (keyup.enter)="onSearch()">
      <button class="search-button" (click)="onSearch()">
        <i class="fas fa-search"></i> Search
      </button>
    </div>

    <div class="filter-box">
      <label class="filter-label">View:</label>
      <select class="filter-select" [(ngModel)]="filterType" (change)="onFilterChange()">
        <option value="active">Active Users</option>
        <option value="deleted">Deleted Users</option>
      </select>
    </div>
  </div>

  <div *ngIf="loading" class="loading-state">
    <div class="spinner"></div>
    <span>Loading users...</span>
  </div>

  <div *ngIf="errorMessage" class="error-state">
    <i class="fas fa-exclamation-circle"></i>
    <span>{{ errorMessage }}</span>
  </div>

  <div *ngIf="!loading && users.length > 0" class="users-table-wrapper">
    <table class="users-table">
      <thead>
        <tr>
          <th>Username</th>
          <th>Email</th>
          <th>Role</th>
          <th>Status</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let user of users">
          <td>{{ user.userName }}</td>
          <td>{{ user.email }}</td>
          
          <td *ngIf="editingUserId !== user._id">{{ user.role }}</td>
          <td *ngIf="editingUserId === user._id">
            <select class="role-select" [(ngModel)]="newRole">
              <option value="user">User</option>
              <option value="admin">Admin</option>
            </select>
          </td>
          
          <td [class.text-danger]="user.isDeleted">
            {{ user.isDeleted ? 'Deleted' : 'Active' }}
          </td>
          
          <td class="actions-column">
            <ng-container *ngIf="!user.isDeleted">
              <button *ngIf="editingUserId !== user._id" 
                      class="btn-edit" 
                      (click)="startEditRole(user)">
                <i class="fas fa-edit"></i> Edit
              </button>
              <button *ngIf="editingUserId === user._id" 
                      class="btn-save" 
                      (click)="saveRole(user._id)">
                <i class="fas fa-check"></i> Save
              </button>
              <button *ngIf="editingUserId === user._id" 
                      class="btn-cancel" 
                      (click)="cancelEdit()">
                <i class="fas fa-times"></i> Cancel
              </button>
              <button class="btn-delete" (click)="confirmDelete(user._id)">
                <i class="fas fa-trash"></i> Delete
              </button>
            </ng-container>
            
            <ng-container *ngIf="user.isDeleted">
              <button class="btn-restore" (click)="confirmRestore(user._id)">
                <i class="fas fa-undo"></i> Restore
              </button>
            </ng-container>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div *ngIf="!loading && users.length === 0" class="empty-state">
    <i class="fas fa-users-slash"></i>
    <p>No users found</p>
  </div>

  <div *ngIf="totalPages > 1" class="pagination-controls">
    <button class="page-btn" 
            (click)="changePage(currentPage - 1)" 
            [disabled]="currentPage === 1">
      <i class="fas fa-chevron-left"></i> Previous
    </button>
    <span class="page-info">
      Page {{ currentPage }} of {{ totalPages }}
    </span>
    <button class="page-btn" 
            (click)="changePage(currentPage + 1)" 
            [disabled]="currentPage === totalPages">
      Next <i class="fas fa-chevron-right"></i>
    </button>
  </div>
</div>